sudo: false
dist: trusty
language: c
services:
  - docker

jobs:
   include:
     - stage: build image from VERSION build-arg
       env: VERSION=4.3.1
       install: skip
       script:
       - docker build --tag existdb/existdb:${VERSION} --build-arg "VERSION=${VERSION}" .
       - docker-compose up -d
       - docker ps -a
       - docker-compose down
     - stage: build image from BRANCH build-arg
       env: DOCKER_TAG=3b195797a
       install: skip
       script:
       - docker build --tag existdb/existdb:${DOCKER_TAG} --build-arg "BRANCH=${DOCKER_TAG}"  .
       - docker-compose up -d
       - docker ps -a
       - docker-compose down

